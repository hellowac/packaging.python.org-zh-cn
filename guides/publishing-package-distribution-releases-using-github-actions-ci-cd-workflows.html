<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="ç´¢å¼•" href="../genindex.html" /><link rel="search" title="æœç´¢" href="../search.html" /><link rel="next" title="å¦‚ä½•ä½¿åŸºäº setup.py çš„é¡¹ç›®ç°ä»£åŒ–ï¼Ÿ" href="modernize-setup-py-project.html" /><link rel="prev" title="åˆ¶ä½œé€‚åˆ PyPI çš„ README" href="making-a-pypi-friendly-readme.html" />

    <link rel="shortcut icon" href="../_static/py.png"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>ä½¿ç”¨ GitHub Actions CI/CD å·¥ä½œæµå‘å¸ƒè½¯ä»¶åŒ…åˆ†å‘ç‰ˆæœ¬ - Python Packaging User Guide</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Python Packaging User Guide</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Python Packaging User Guide</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="æœç´¢" name="q" aria-label="æœç´¢">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">æ¦‚è¿°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow.html">æ‰“åŒ…æµç¨‹</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">æ•™ç¨‹</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of æ•™ç¨‹</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/installing-packages.html">å®‰è£…è½¯ä»¶åŒ…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/managing-dependencies.html">ç®¡ç†ä¾èµ–é¡¹</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/packaging-projects.html">æ‰“åŒ…Pythoné¡¹ç›®</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">æŒ‡å—</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of æŒ‡å—</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="section-install.html">å®‰è£…</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of å®‰è£…</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="installing-using-pip-and-virtual-environments.html">ä½¿ç”¨ pip å’Œ venv åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…è½¯ä»¶åŒ…</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-using-virtualenv.html">ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå®‰è£…åŒ…</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-stand-alone-command-line-tools.html">å®‰è£…ç‹¬ç«‹çš„å‘½ä»¤è¡Œå·¥å…·</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-using-linux-tools.html">ä½¿ç”¨ Linux åŒ…ç®¡ç†å™¨å®‰è£… pip/setuptools/wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-scientific-packages.html">å®‰è£…ç§‘å­¦è½¯ä»¶åŒ…</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="section-build-and-publish.html">æ„å»ºå’Œå‘å¸ƒ</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of æ„å»ºå’Œå‘å¸ƒ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="writing-pyproject-toml.html">ç¼–å†™ä½ çš„ <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="distributing-packages-using-setuptools.html">æ‰“åŒ…å’Œåˆ†å‘é¡¹ç›®</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropping-older-python-versions.html">æ”¾å¼ƒå¯¹æ—§ç‰ˆ Python çš„æ”¯æŒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="packaging-binary-extensions.html">æ‰“åŒ…äºŒè¿›åˆ¶æ‰©å±•</a></li>
<li class="toctree-l3"><a class="reference internal" href="packaging-namespace-packages.html">æ‰“åŒ…å‘½åç©ºé—´åŒ…</a></li>
<li class="toctree-l3"><a class="reference internal" href="creating-command-line-tools.html">åˆ›å»ºå’Œæ‰“åŒ…å‘½ä»¤è¡Œå·¥å…·</a></li>
<li class="toctree-l3"><a class="reference internal" href="creating-and-discovering-plugins.html">åˆ›å»ºå’Œå‘ç°æ’ä»¶</a></li>
<li class="toctree-l3"><a class="reference internal" href="using-testpypi.html">ä½¿ç”¨ TestPyPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="making-a-pypi-friendly-readme.html">åˆ¶ä½œé€‚åˆ PyPI çš„ README</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">ä½¿ç”¨ GitHub Actions CI/CD å·¥ä½œæµå‘å¸ƒè½¯ä»¶åŒ…åˆ†å‘ç‰ˆæœ¬</a></li>
<li class="toctree-l3"><a class="reference internal" href="modernize-setup-py-project.html">å¦‚ä½•ä½¿åŸºäº <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> çš„é¡¹ç›®ç°ä»£åŒ–ï¼Ÿ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="section-hosting.html">æ‰˜ç®¡</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of æ‰˜ç®¡</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="index-mirrors-and-caches.html">åŒ…ç´¢å¼•é•œåƒå’Œç¼“å­˜</a></li>
<li class="toctree-l3"><a class="reference internal" href="hosting-your-own-index.html">æ‰˜ç®¡æ‚¨è‡ªå·±çš„ç®€å•å­˜å‚¨åº“</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tool-recommendations.html">å·¥å…·æ¨è</a></li>
<li class="toctree-l2"><a class="reference internal" href="analyzing-pypi-package-downloads.html">åˆ†æ PyPI è½¯ä»¶åŒ…ä¸‹è½½</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discussions/index.html">è®¨è®º</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of è®¨è®º</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../discussions/versioning.html">ç‰ˆæœ¬æ§åˆ¶</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/deploying-python-applications.html">éƒ¨ç½² Python åº”ç”¨ç¨‹åº</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/pip-vs-easy-install.html">pip vs easy_install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/install-requires-vs-requirements.html">install_requires ä¸éœ€æ±‚æ–‡ä»¶</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/distribution-package-vs-import-package.html">åˆ†å‘åŒ…ä¸å¯¼å…¥åŒ…</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/package-formats.html">è½¯ä»¶åŒ…æ ¼å¼</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/src-layout-vs-flat-layout.html">src å¸ƒå±€ä¸å¹³é¢å¸ƒå±€</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/setup-py-deprecated.html"><code class="docutils literal notranslate"><span class="pre">setup.py</span></code> å·²è¢«å¼ƒç”¨å—ï¼Ÿ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/single-source-version.html">å•ä¸€æ¥æºé¡¹ç›®ç‰ˆæœ¬</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../specifications/index.html">PyPA è§„èŒƒ</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of PyPA è§„èŒƒ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-distribution-metadata.html">åŒ…åˆ†å‘å…ƒæ•°æ®</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of åŒ…åˆ†å‘å…ƒæ•°æ®</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/name-normalization.html">åç§°å’Œè§„èŒƒåŒ–</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/core-metadata.html">æ ¸å¿ƒå…ƒæ•°æ®è§„èŒƒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/version-specifiers.html">ç‰ˆæœ¬æ ‡è¯†ç¬¦</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/dependency-specifiers.html">ä¾èµ–è¯´æ˜ç¬¦</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/pyproject-toml.html"><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> è§„èŒƒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/inline-script-metadata.html">å†…è”è„šæœ¬å…ƒæ•°æ®</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/platform-compatibility-tags.html">å¹³å°å…¼å®¹æ€§æ ‡ç­¾</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/well-known-project-urls.html">å…ƒæ•°æ®ä¸­çš„çŸ¥åé¡¹ç›® URL</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-installation-metadata.html">åŒ…å®‰è£…å…ƒæ•°æ®</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of åŒ…å®‰è£…å…ƒæ•°æ®</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/recording-installed-packages.html">è®°å½•å·²å®‰è£…çš„é¡¹ç›®</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/entry-points.html">å…¥å£ç‚¹è§„èŒƒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/direct-url.html">è®°å½•å·²å®‰è£…å‘è¡Œç‰ˆçš„ç›´æ¥ URL æ¥æº</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/direct-url-data-structure.html">ç›´æ¥ URL æ•°æ®ç»“æ„</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/virtual-environments.html">Python è™šæ‹Ÿç¯å¢ƒ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/externally-managed-environments.html">å¤–éƒ¨ç®¡ç†ç¯å¢ƒ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-distribution-formats.html">åŒ…åˆ†å‘æ–‡ä»¶æ ¼å¼</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of åŒ…åˆ†å‘æ–‡ä»¶æ ¼å¼</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/source-distribution-format.html">æºåˆ†å‘æ ¼å¼</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/binary-distribution-format.html">äºŒè¿›åˆ¶åˆ†å‘æ ¼å¼</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-package-indices.html">åŒ…ç´¢å¼•æ¥å£</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of åŒ…ç´¢å¼•æ¥å£</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/pypirc.html"><code class="file docutils literal notranslate"><span class="pre">.pypirc</span></code> æ–‡ä»¶</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/simple-repository-api.html">Simple ä»“åº“ API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../key_projects.html">é¡¹ç›®æ‘˜è¦</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">æœ¯è¯­</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">å¦‚ä½•è·å–æ”¯æŒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">ä¸ºæœ¬æŒ‡å—åšå‡ºè´¡çŒ®</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news.html">æ–°é—»</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/guides/publishing-package-distribution-releases-using-github-actions-ci-cd-workflows.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="github-actions-ci-cd">
<span id="trusted-publishing"></span><h1>ä½¿ç”¨ GitHub Actions CI/CD å·¥ä½œæµå‘å¸ƒè½¯ä»¶åŒ…åˆ†å‘ç‰ˆæœ¬<a class="headerlink" href="#github-actions-ci-cd" title="Link to this heading">Â¶</a></h1>
<p><strong>Publishing package distribution releases using GitHub Actions CI/CD workflows</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p><a class="reference external" href="https://github.com/features/actions">GitHub Actions CI/CD</a> å…è®¸ä½ åœ¨ GitHub å¹³å°ä¸Šå‘ç”Ÿäº‹ä»¶æ—¶è¿è¡Œä¸€ç³»åˆ—å‘½ä»¤ã€‚ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯é€šè¿‡ <code class="docutils literal notranslate"><span class="pre">push</span></code> äº‹ä»¶è§¦å‘å·¥ä½œæµã€‚
æœ¬æŒ‡å—å±•ç¤ºäº†å¦‚ä½•åœ¨æ¯æ¬¡æ¨é€å¸¦æ ‡ç­¾çš„æäº¤æ—¶å‘å¸ƒ Python åˆ†å‘åŒ…ã€‚
å®ƒå°†ä½¿ç”¨ <a class="reference external" href="https://github.com/marketplace/actions/pypi-publish">pypa/gh-action-pypi-publish GitHub Action</a> æ¥è¿›è¡Œå‘å¸ƒï¼Œè¿˜å°†ä½¿ç”¨ GitHub çš„ <a class="reference external" href="https://github.com/actions/upload-artifact">upload-artifact</a> å’Œ <a class="reference external" href="https://github.com/actions/download-artifact">download-artifact</a> åŠ¨ä½œæ¥ä¸´æ—¶å­˜å‚¨å’Œä¸‹è½½æºä»£ç åŒ…ã€‚</p>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>æœ¬æŒ‡å— <em>å‡è®¾</em> ä½ å·²ç»æœ‰ä¸€ä¸ªä½ çŸ¥é“å¦‚ä½•æ„å»ºåˆ†å‘åŒ…çš„é¡¹ç›®ï¼Œå¹¶ä¸” <em>è¯¥é¡¹ç›®æ‰˜ç®¡åœ¨ GitHub ä¸Š</em>ã€‚æœ¬æŒ‡å—è¿˜é¿å…äº†æ„å»ºå¹³å°ç‰¹å®šé¡¹ç›®çš„ç»†èŠ‚ã€‚å¦‚æœä½ çš„é¡¹ç›®åŒ…å«äºŒè¿›åˆ¶ç»„ä»¶ï¼Œè¯·æŸ¥çœ‹ <a class="reference internal" href="../key_projects.html#cibuildwheel"><span class="std std-ref">cibuildwheel</span></a> çš„ GitHub Action ç¤ºä¾‹ã€‚</p>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p><a class="reference external" href="https://github.com/features/actions">GitHub Actions CI/CD</a> allows you to run a series of commands
whenever an event occurs on the GitHub platform. One
popular choice is having a workflow that's triggered by a
<code class="docutils literal notranslate"><span class="pre">push</span></code> event.
This guide shows you how to publish a Python distribution
whenever a tagged commit is pushed.
It will use the <a class="reference external" href="https://github.com/marketplace/actions/pypi-publish">pypa/gh-action-pypi-publish GitHub Action</a> for
publishing. It also uses GitHub's <a class="reference external" href="https://github.com/actions/upload-artifact">upload-artifact</a> and <a class="reference external" href="https://github.com/actions/download-artifact">download-artifact</a> actions
for temporarily storing and downloading the source packages.</p>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>This guide <em>assumes</em> that you already have a project that you know how to
build distributions for and <em>it lives on GitHub</em>.  This guide also avoids
details of building platform specific projects. If you have binary
components, check out <a class="reference internal" href="../key_projects.html#cibuildwheel"><span class="std std-ref">cibuildwheel</span></a>'s GitHub Action examples.</p>
</div>
</div>
</div>
<section id="id1">
<h2>é…ç½®å—ä¿¡ä»»çš„å‘å¸ƒ<a class="headerlink" href="#id1" title="Link to this heading">Â¶</a></h2>
<p><strong>Configuring trusted publishing</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>æœ¬æŒ‡å—ä¾èµ–äº PyPI çš„ <a class="reference external" href="https://docs.pypi.org/trusted-publishers/">trusted publishing</a> å®ç°æ¥è¿æ¥åˆ° <a class="reference external" href="https://github.com/features/actions">GitHub Actions CI/CD</a>ã€‚å‡ºäºå®‰å…¨åŸå› ï¼Œæ¨èä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºç”Ÿæˆçš„ä»¤ç‰Œæ˜¯ä¸ºæ¯ä¸ªé¡¹ç›®å•ç‹¬åˆ›å»ºçš„ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨è¿‡æœŸã€‚å¦åˆ™ï¼Œä½ å°†éœ€è¦ä¸º PyPI å’Œ TestPyPI åˆ†åˆ«ç”Ÿæˆ <a class="reference external" href="APItoken">API ä»¤ç‰Œ</a>ã€‚å¦‚æœè¦å‘å¸ƒåˆ°ç¬¬ä¸‰æ–¹ç´¢å¼•ï¼Œå¦‚ <a class="reference external" href="https://devpi.net/docs/devpi/devpi/latest/+doc/index.html" title="ï¼ˆåœ¨ devpi v6.13ï¼‰"><span class="xref std std-doc">devpi</span></a>ï¼Œä½ å¯èƒ½éœ€è¦æä¾›ç”¨æˆ·å/å¯†ç ç»„åˆã€‚</p>
<p>ç”±äºæœ¬æŒ‡å—å°†æ¼”ç¤ºå¦‚ä½•åŒæ—¶ä¸Šä¼ åˆ° PyPI å’Œ TestPyPIï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é…ç½®ä¸¤ä¸ªå—ä¿¡ä»»çš„å‘å¸ƒè€…ã€‚ä»¥ä¸‹æ­¥éª¤å°†å¼•å¯¼ä½ åˆ›å»ºæ–°çš„ <a class="reference internal" href="../glossary.html#term-Project"><span class="xref std std-term">PyPI é¡¹ç›®</span></a> çš„â€œå¾…å®šâ€å‘å¸ƒè€…ã€‚
ä½†å¦‚æœä½ æ˜¯æŸä¸ªç°æœ‰é¡¹ç›®çš„æ‰€æœ‰è€…ï¼Œä¹Ÿå¯ä»¥å°† <a class="reference external" href="https://docs.pypi.org/trusted-publishers/">trusted publishing</a> æ·»åŠ åˆ°ä»»ä½•å·²å­˜åœ¨çš„é¡¹ç›®ã€‚</p>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>å¦‚æœä½ è·Ÿéšäº†æ—©æœŸç‰ˆæœ¬çš„æœ¬æŒ‡å—ï¼Œä½ å·²ç»ä¸ºç›´æ¥è®¿é—® PyPI å’Œ TestPyPI åˆ›å»ºäº†ç§˜å¯† <code class="xref any docutils literal notranslate"><span class="pre">PYPI_API_TOKEN</span></code> å’Œ <code class="xref any docutils literal notranslate"><span class="pre">TEST_PYPI_API_TOKEN</span></code>ã€‚è¿™äº›ç°åœ¨å·²ç»è¿‡æ—¶ï¼Œå¦‚æœä½ æ‰“ç®—ç”¨æ–°çš„è®¾ç½®æ›¿ä»£æ—§çš„è®¾ç½®ï¼Œè¯·ä»ä½ çš„ GitHub ä»“åº“ä¸­åˆ é™¤å®ƒä»¬ï¼Œå¹¶åœ¨ä½ çš„ PyPI å’Œ TestPyPI è´¦æˆ·è®¾ç½®ä¸­æ’¤é”€å®ƒä»¬ã€‚</p>
</div>
<p>å¼€å§‹å§ï¼ ğŸš€</p>
<ol class="arabic">
<li><p>è®¿é—® <a class="reference external" href="https://pypi.org/manage/account/publishing/">https://pypi.org/manage/account/publishing/</a>ã€‚</p></li>
<li><p>å¡«å…¥ä½ å¸Œæœ›å‘å¸ƒæ–° <a class="reference internal" href="../glossary.html#term-Project"><span class="xref std std-term">PyPI é¡¹ç›®</span></a> çš„åç§°ï¼ˆå³ä½  <a class="reference internal" href="../glossary.html#term-setup.cfg"><code class="xref any std std-term docutils literal notranslate"><span class="pre">setup.cfg</span></code></a> æˆ– <a class="reference internal" href="../glossary.html#term-pyproject.toml"><code class="xref any std std-term docutils literal notranslate"><span class="pre">pyproject.toml</span></code></a> æ–‡ä»¶ä¸­çš„ <a class="reference external" href="https://pybind11.readthedocs.io/en/stable/reference.html#_CPPv44name" title="ï¼ˆåœ¨ pybind11 v2.13.6ï¼‰"><code class="xref any docutils literal notranslate"><span class="pre">name</span></code></a> å€¼ï¼‰ã€GitHub ä»“åº“æ‰€æœ‰è€…çš„åç§°ï¼ˆç»„ç»‡æˆ–ç”¨æˆ·ï¼‰ã€ä»“åº“åç§°ï¼Œä»¥åŠ <code class="xref any docutils literal notranslate"><span class="pre">release</span> <span class="pre">workflow</span></code> æ–‡ä»¶åœ¨ <code class="xref any docutils literal notranslate"><span class="pre">.github/</span></code> æ–‡ä»¶å¤¹ä¸‹çš„åç§°ï¼Œè§ <a class="reference internal" href="#workflow-definition"><span class="std std-ref">åˆ›å»ºå·¥ä½œæµå®šä¹‰</span></a>ã€‚æœ€åï¼Œæ·»åŠ æˆ‘ä»¬å°†åœ¨ä½ çš„ä»“åº“ä¸‹è®¾ç½®çš„ GitHub ç¯å¢ƒåç§°ï¼ˆ<code class="xref any docutils literal notranslate"><span class="pre">pypi</span></code>ï¼‰ã€‚æ³¨å†Œå—ä¿¡ä»»çš„å‘å¸ƒè€…ã€‚</p></li>
<li><p>ç„¶åï¼Œè®¿é—® <a class="reference external" href="https://test.pypi.org/manage/account/publishing/">https://test.pypi.org/manage/account/publishing/</a>ï¼Œé‡å¤ç¬¬äºŒæ­¥ï¼Œä½†è¿™æ¬¡è¾“å…¥ <code class="xref any docutils literal notranslate"><span class="pre">testpypi</span></code> ä½œä¸º GitHub ç¯å¢ƒçš„åç§°ã€‚</p></li>
<li><p>ä½ çš„â€œå¾…å®šâ€å‘å¸ƒè€…ç°åœ¨å·²ç»å‡†å¤‡å¥½é¦–æ¬¡ä½¿ç”¨ï¼Œå¹¶ä¸”ä¼šåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨åˆ›å»ºä½ çš„é¡¹ç›®ã€‚</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>å¦‚æœä½ æ²¡æœ‰ TestPyPI è´¦æˆ·ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªã€‚å®ƒä¸æ™®é€šçš„ PyPI è´¦æˆ·ä¸åŒã€‚</p>
</div>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>å‡ºäºå®‰å…¨åŸå› ï¼Œä½ å¿…é¡»å¯¹æ¯æ¬¡è¿è¡Œè¦æ±‚ <a class="reference external" href="https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment#deployment-protection-rules">æ‰‹åŠ¨æ‰¹å‡†</a>ï¼Œå°¤å…¶æ˜¯å¯¹ <code class="xref any docutils literal notranslate"><span class="pre">pypi</span></code> ç¯å¢ƒçš„æ¯æ¬¡è¿è¡Œã€‚</p>
</div>
</li>
</ol>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>This guide relies on PyPI's <a class="reference external" href="https://docs.pypi.org/trusted-publishers/">trusted publishing</a> implementation to connect
to <a class="reference external" href="https://github.com/features/actions">GitHub Actions CI/CD</a>. This is recommended for security reasons, since
the generated tokens are created for each of your projects
individually and expire automatically. Otherwise, you'll need to generate an
<a class="reference external" href="https://pypi.org/help/#apitoken">API token</a> for both PyPI and TestPyPI. In case of publishing to third-party
indexes like <a class="reference external" href="https://devpi.net/docs/devpi/devpi/latest/+doc/index.html" title="ï¼ˆåœ¨ devpi v6.13ï¼‰"><span class="xref std std-doc">devpi</span></a>, you may need to provide a
username/password combination.</p>
<p>Since this guide will demonstrate uploading to both
PyPI and TestPyPI, we'll need two trusted publishers configured.
The following steps will lead you through creating the &quot;pending&quot; publishers
for your new <a class="reference internal" href="../glossary.html#term-Project"><span class="xref std std-term">PyPI project</span></a>.
However it is also possible to add <a class="reference external" href="https://docs.pypi.org/trusted-publishers/">trusted publishing</a> to any
pre-existing project, if you are its owner.</p>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>If you followed earlier versions of this guide, you
have created the secrets <code class="docutils literal notranslate"><span class="pre">PYPI_API_TOKEN</span></code> and <code class="docutils literal notranslate"><span class="pre">TEST_PYPI_API_TOKEN</span></code>
for direct PyPI and TestPyPI access. These are obsolete now and
you should remove them from your GitHub repository and revoke
them in your PyPI and TestPyPI account settings in case you are replacing your old setup with the new one.</p>
</div>
<p>Let's begin! ğŸš€</p>
<ol class="arabic">
<li><p>Go to <a class="reference external" href="https://pypi.org/manage/account/publishing/">https://pypi.org/manage/account/publishing/</a>.</p></li>
<li><p>Fill in the name you wish to publish your new
<a class="reference internal" href="../glossary.html#term-Project"><span class="xref std std-term">PyPI project</span></a> under
(the <code class="docutils literal notranslate"><span class="pre">name</span></code> value in your <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> or <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>),
the GitHub repository owner's name (org or user),
and repository name, and the name of the release workflow file under
the <code class="docutils literal notranslate"><span class="pre">.github/</span></code> folder, see <a class="reference internal" href="#workflow-definition"><span class="std std-ref">åˆ›å»ºå·¥ä½œæµå®šä¹‰</span></a>.
Finally, add the name of the GitHub Environment
(<code class="docutils literal notranslate"><span class="pre">pypi</span></code>) we're going set up under your repository.
Register the trusted publisher.</p></li>
<li><p>Now, go to <a class="reference external" href="https://test.pypi.org/manage/account/publishing/">https://test.pypi.org/manage/account/publishing/</a> and repeat
the second step, but this time, enter <code class="docutils literal notranslate"><span class="pre">testpypi</span></code> as the name of the
GitHub Environment.</p></li>
<li><p>Your &quot;pending&quot; publishers are now ready for their first use and will
create your projects automatically once you use them
for the first time.</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>If you don't have a TestPyPI account, you'll need to
create it. It's not the same as a regular PyPI account.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>For security reasons, you must require <a class="reference external" href="https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment#deployment-protection-rules">manual approval</a>
on each run for the <code class="docutils literal notranslate"><span class="pre">pypi</span></code> environment.</p>
</div>
</li>
</ol>
</div>
</div>
</section>
<section id="workflow-definition">
<span id="id3"></span><h2>åˆ›å»ºå·¥ä½œæµå®šä¹‰<a class="headerlink" href="#workflow-definition" title="Link to this heading">Â¶</a></h2>
<p><strong>Creating a workflow definition</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>GitHub CI/CD å·¥ä½œæµåœ¨å­˜å‚¨åº“çš„ <code class="docutils literal notranslate"><span class="pre">.github/workflows/</span></code> ç›®å½•ä¸‹çš„ YAML æ–‡ä»¶ä¸­å£°æ˜ã€‚</p>
<p>æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª <code class="docutils literal notranslate"><span class="pre">.github/workflows/publish-to-test-pypi.yml</span></code> æ–‡ä»¶ã€‚</p>
<p>é¦–å…ˆç»™å®ƒèµ·ä¸€ä¸ªæœ‰æ„ä¹‰çš„åå­—ï¼Œå¹¶å®šä¹‰è§¦å‘ GitHub è¿è¡Œæ­¤å·¥ä½œæµçš„äº‹ä»¶ï¼š</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to PyPI and TestPyPI</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">push</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>GitHub CI/CD workflows are declared in YAML files stored in the
<code class="docutils literal notranslate"><span class="pre">.github/workflows/</span></code> directory of your repository.</p>
<p>Let's create a <code class="docutils literal notranslate"><span class="pre">.github/workflows/publish-to-test-pypi.yml</span></code>
file.</p>
<p>Start it with a meaningful name and define the event that
should make GitHub run this workflow:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to PyPI and TestPyPI</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">push</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h2>æ£€æŸ¥é¡¹ç›®å¹¶æ„å»ºåˆ†å‘<a class="headerlink" href="#id4" title="Link to this heading">Â¶</a></h2>
<p><strong>Checking out the project and building distributions</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸¤ä¸ªä½œä¸šåˆ†åˆ«å‘å¸ƒåˆ° PyPI å’Œ TestPyPIï¼Œä»¥åŠä¸€ä¸ªé¢å¤–çš„ä½œä¸šæ¥æ„å»ºå‘è¡ŒåŒ…ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ç”¨äºæ„å»ºé¡¹ç›®çš„å‘è¡ŒåŒ…å¹¶å°†å…¶å­˜å‚¨ä»¥å¤‡åç”¨çš„ä½œä¸šï¼š</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build distribution ğŸ“¦</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.x&quot;</span>
</pre></div>
</div>
<p>è¿™å°†æŠŠä½ çš„å­˜å‚¨åº“ä¸‹è½½åˆ° CI è¿è¡Œå™¨ä¸­ï¼Œç„¶åå®‰è£…å¹¶æ¿€æ´»æœ€æ–°çš„å¯ç”¨ Python 3 ç‰ˆæœ¬ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»æºä»£ç æ„å»ºå‘è¡ŒåŒ…å¹¶å°†å…¶å­˜å‚¨ã€‚
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">build</span></code> åŒ…ã€‚
æ‰€ä»¥å°†å…¶æ·»åŠ åˆ°æ­¥éª¤åˆ—è¡¨ä¸­ï¼š</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install pypa/build</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">python3 -m</span>
<span class="w">        </span><span class="no">pip install</span>
<span class="w">        </span><span class="no">build</span>
<span class="w">        </span><span class="no">--user</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build a binary wheel and a source tarball</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3 -m build</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Store the distribution packages</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>We will have to define two jobs to publish to PyPI
and TestPyPI respectively, and an additional job to
build the distribution packages.</p>
<p>First, we'll define the job for building the dist packages of
your project and storing them for later use:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build distribution ğŸ“¦</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.x&quot;</span>
</pre></div>
</div>
<p>This will download your repository into the CI runner and then
install and activate the newest available Python 3 release.</p>
<p>And now we can build the dists from source and store them.
In this example, we'll use the <code class="docutils literal notranslate"><span class="pre">build</span></code> package.
So add this to the steps list:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install pypa/build</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">python3 -m</span>
<span class="w">        </span><span class="no">pip install</span>
<span class="w">        </span><span class="no">build</span>
<span class="w">        </span><span class="no">--user</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build a binary wheel and a source tarball</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3 -m build</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Store the distribution packages</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2>å®šä¹‰å·¥ä½œæµä½œä¸šç¯å¢ƒ<a class="headerlink" href="#id5" title="Link to this heading">Â¶</a></h2>
<p><strong>Defining a workflow job environment</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸ºå‘å¸ƒåˆ° PyPI çš„ä½œä¸šæ·»åŠ åˆå§‹è®¾ç½®ã€‚
è¿™æ˜¯ä¸€ä¸ªæ‰§è¡Œæˆ‘ä»¬ç¨åå®šä¹‰çš„å‘½ä»¤çš„è¿‡ç¨‹ã€‚
åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ GitHub Actions æä¾›çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„ Ubuntu LTSã€‚
è¿™è¿˜å®šä¹‰äº†ä¸€ä¸ª GitHub ç¯å¢ƒï¼Œä½œä¸šå°†åœ¨å…¶ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œå¹¶æä¾›ä¸€ä¸ªåœ¨ GitHub UI ä¸­æ˜¾ç¤ºçš„ URLï¼Œä¾¿äºæŸ¥çœ‹ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å…è®¸è·å–ä¸€ä¸ª OpenID Connect ä»¤ç‰Œï¼Œè¿™æ˜¯ <code class="docutils literal notranslate"><span class="pre">pypi-publish</span></code> åŠ¨ä½œå®ç°æ— å¯†é’¥ä¿¡ä»»å‘å¸ƒåˆ° PyPI æ‰€å¿…éœ€çš„ã€‚</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">publish-to-pypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Publish Python ğŸ distribution ğŸ“¦ to PyPI</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">startsWith(github.ref, &#39;refs/tags/&#39;)</span><span class="w">  </span><span class="c1"># only publish to PyPI on tag pushes</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://pypi.org/p/&lt;package-name&gt;</span><span class="w">  </span><span class="c1"># Replace &lt;package-name&gt; with your PyPI project name</span>
<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>
</pre></div>
</div>
<p>è¿™ä¹Ÿç¡®ä¿äº†åªæœ‰å½“å½“å‰æäº¤è¢«æ ‡è®°æ—¶ï¼Œæ‰ä¼šè§¦å‘ PyPI å‘å¸ƒå·¥ä½œæµã€‚</p>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>Now, let's add initial setup for our job that will publish to PyPI.
It's a process that will execute commands that we'll define later.
In this guide, we'll use the latest stable Ubuntu LTS version
provided by GitHub Actions. This also defines a GitHub Environment
for the job to run in its context and a URL to be displayed in GitHub's
UI nicely. Additionally, it allows acquiring an OpenID Connect token
that the <code class="docutils literal notranslate"><span class="pre">pypi-publish</span></code> actions needs to implement secretless
trusted publishing to PyPI.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">publish-to-pypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Publish Python ğŸ distribution ğŸ“¦ to PyPI</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">startsWith(github.ref, &#39;refs/tags/&#39;)</span><span class="w">  </span><span class="c1"># only publish to PyPI on tag pushes</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://pypi.org/p/&lt;package-name&gt;</span><span class="w">  </span><span class="c1"># Replace &lt;package-name&gt; with your PyPI project name</span>
<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>
</pre></div>
</div>
<p>This will also ensure that the PyPI publishing workflow is only triggered
if the current commit is tagged.</p>
</div>
</div>
</section>
<section id="pypi">
<h2>å°†åˆ†å‘å‘å¸ƒåˆ° PyPI<a class="headerlink" href="#pypi" title="Link to this heading">Â¶</a></h2>
<p><strong>Publishing the distribution to PyPI</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>æœ€åï¼Œåœ¨æœ«å°¾æ·»åŠ ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to PyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>
</pre></div>
</div>
<p>æ­¤æ­¥éª¤ä½¿ç”¨äº† <a class="reference external" href="https://github.com/pypa/gh-action-pypi-publish">pypa/gh-action-pypi-publish</a> GitHub Actionï¼šåœ¨ <a class="reference external" href="https://github.com/actions/download-artifact">download-artifact</a> åŠ¨ä½œä¸‹è½½äº†å­˜å‚¨çš„åˆ†å‘åŒ…ä¹‹åï¼Œå®ƒä¼šæ— æ¡ä»¶åœ°å°† <code class="docutils literal notranslate"><span class="pre">dist/</span></code> æ–‡ä»¶å¤¹çš„å†…å®¹ä¸Šä¼ åˆ° PyPIã€‚</p>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>Finally, add the following steps at the end:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to PyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>
</pre></div>
</div>
<p>This step uses the <a class="reference external" href="https://github.com/pypa/gh-action-pypi-publish">pypa/gh-action-pypi-publish</a> GitHub
Action: after the stored distribution package has been
downloaded by the <a class="reference external" href="https://github.com/actions/download-artifact">download-artifact</a> action, it uploads
the contents of the <code class="docutils literal notranslate"><span class="pre">dist/</span></code> folder into PyPI unconditionally.</p>
</div>
</div>
</section>
<section id="id6">
<h2>ç­¾ç½²åˆ†å‘åŒ…<a class="headerlink" href="#id6" title="Link to this heading">Â¶</a></h2>
<p><strong>Signing the distribution packages</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>ä»¥ä¸‹ä»»åŠ¡ä½¿ç”¨ <a class="reference external" href="https://www.sigstore.dev/">Sigstore</a> å¯¹åˆ†å‘åŒ…è¿›è¡Œç­¾åï¼Œ <code class="docutils literal notranslate"><span class="pre">Sigstore</span></code> æ˜¯ <a class="reference external" href="https://www.python.org/download/sigstore/">ç”¨äºç­¾ç½² CPython</a> çš„ç›¸åŒå·¥ä»¶ç­¾åç³»ç»Ÿ ã€‚</p>
<p>é¦–å…ˆï¼Œå®ƒä½¿ç”¨ <a class="reference external" href="https://github.com/marketplace/actions/gh-action-sigstore-python">sigstore/gh-action-sigstore-python GitHub Action</a> æ¥ç­¾ç½²åˆ†å‘åŒ…ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">gh</span></code> CLI ä»å½“å‰æ ‡ç­¾åˆ›å»ºä¸€ä¸ªç©ºçš„ GitHub å‘å¸ƒã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸€æ­¥å¯ä»¥è¿›ä¸€æ­¥è‡ªå®šä¹‰ã€‚å¯ä»¥å‚è€ƒ <a class="reference external" href="https://cli.github.com/manual/gh_release">gh release æ–‡æ¡£</a>ã€‚</p>
<div class="admonition tip">
<p class="admonition-title">å°æŠ€å·§</p>
<p>ä½ å¯èƒ½éœ€è¦ç®¡ç†ä½ çš„ <code class="docutils literal notranslate"><span class="pre">GITHUB_TOKEN</span></code> æƒé™ï¼Œä»¥
å¯ç”¨åˆ›å»º GitHub å‘å¸ƒã€‚æœ‰å…³è¯´æ˜ï¼Œè¯·å‚é˜… <a class="reference external" href="https://docs.github.com/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#configuring-the-default-github_token-permissions">GitHub æ–‡æ¡£</a>ã€‚
ç‰¹åˆ«æ˜¯ï¼Œä»¤ç‰Œéœ€è¦ <code class="docutils literal notranslate"><span class="pre">contents:</span> <span class="pre">write</span></code> æƒé™ã€‚</p>
</div>
<p>æœ€åï¼Œå·²ç­¾åçš„åˆ†å‘åŒ…å°†ä¸Šä¼ åˆ° GitHub å‘å¸ƒä¸­ã€‚</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">github-release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Sign the Python ğŸ distribution ğŸ“¦ with Sigstore</span>
<span class="w">      </span><span class="no">and upload them to GitHub Release</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">publish-to-pypi</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for making GitHub Releases</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for sigstore</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Sign the dists with Sigstore</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sigstore/gh-action-sigstore-python@v3.0.0</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">          </span><span class="no">./dist/*.tar.gz</span>
<span class="w">          </span><span class="no">./dist/*.whl</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release create</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39;</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>
<span class="w">        </span><span class="no">--notes &quot;&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload artifact signatures to GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="c1"># Upload to GitHub Release using the `gh` CLI.</span>
<span class="w">      </span><span class="c1"># `dist/` contains the built packages, and the</span>
<span class="w">      </span><span class="c1"># sigstore-produced signatures and certificates.</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release upload</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39; dist/**</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>è¿™æ˜¯ GPG ç­¾åçš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ”¯æŒ GPG ç­¾åçš„åŠŸèƒ½ <a class="reference external" href="https://blog.pypi.org/posts/2023-05-23-removing-pgp/">å·²ä» PyPI ä¸­ ç§»é™¤</a>ã€‚ ç„¶è€Œï¼Œè¿™ä¸ªä»»åŠ¡å¯¹äºä¸Šä¼ åˆ° PyPI ä¸æ˜¯å¼ºåˆ¶è¦æ±‚çš„ï¼Œå¯ä»¥çœç•¥ã€‚</p>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>The following job signs the distribution packages with <a class="reference external" href="https://www.sigstore.dev/">Sigstore</a>,
the same artifact signing system <a class="reference external" href="https://www.python.org/download/sigstore/">used to sign CPython</a>.</p>
<p>Firstly, it uses the <a class="reference external" href="https://github.com/marketplace/actions/gh-action-sigstore-python">sigstore/gh-action-sigstore-python GitHub Action</a>
to sign the distribution packages. In the next step, an empty GitHub Release
from the current tag is created using the <code class="docutils literal notranslate"><span class="pre">gh</span></code> CLI. Note this step can be further
customised. See the <a class="reference external" href="https://cli.github.com/manual/gh_release">gh release documentation</a>
as a reference.</p>
<div class="admonition tip">
<p class="admonition-title">å°æŠ€å·§</p>
<p>You may need to manage your <code class="docutils literal notranslate"><span class="pre">GITHUB_TOKEN</span></code> permissions to
enable creating the GitHub Release. See the <a class="reference external" href="https://docs.github.com/repositories/managing-your-repositorys-settings-and-features/enabling-features-for-your-repository/managing-github-actions-settings-for-a-repository#configuring-the-default-github_token-permissions">GitHub
documentation</a>
for instructions. Specifically, the token needs the
<code class="docutils literal notranslate"><span class="pre">contents:</span> <span class="pre">write</span></code> permission.</p>
</div>
<p>Finally, the signed distributions are uploaded to the GitHub Release.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">github-release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Sign the Python ğŸ distribution ğŸ“¦ with Sigstore</span>
<span class="w">      </span><span class="no">and upload them to GitHub Release</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">publish-to-pypi</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for making GitHub Releases</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for sigstore</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Sign the dists with Sigstore</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sigstore/gh-action-sigstore-python@v3.0.0</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">          </span><span class="no">./dist/*.tar.gz</span>
<span class="w">          </span><span class="no">./dist/*.whl</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release create</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39;</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>
<span class="w">        </span><span class="no">--notes &quot;&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload artifact signatures to GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="c1"># Upload to GitHub Release using the `gh` CLI.</span>
<span class="w">      </span><span class="c1"># `dist/` contains the built packages, and the</span>
<span class="w">      </span><span class="c1"># sigstore-produced signatures and certificates.</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release upload</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39; dist/**</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>This is a replacement for GPG signatures, for which support has been
<a class="reference external" href="https://blog.pypi.org/posts/2023-05-23-removing-pgp/">removed from PyPI</a>.
However, this job is not mandatory for uploading to PyPI and can be omitted.</p>
</div>
</div>
</div>
</section>
<section id="testpypi">
<h2>ç”¨äºå‘å¸ƒåˆ° TestPyPI çš„å•ç‹¬å·¥ä½œæµ<a class="headerlink" href="#testpypi" title="Link to this heading">Â¶</a></h2>
<p><strong>Separate workflow for publishing to TestPyPI</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>ç°åœ¨ï¼Œé‡å¤è¿™äº›æ­¥éª¤å¹¶åœ¨ <code class="docutils literal notranslate"><span class="pre">jobs</span></code> éƒ¨åˆ†ä¸ºå‘å¸ƒåˆ° TestPyPI åŒ…ç´¢å¼•åˆ›å»ºå¦ä¸€ä¸ªä»»åŠ¡ï¼š</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">publish-to-testpypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to TestPyPI</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testpypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/p/&lt;package-name&gt;</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to TestPyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">repository-url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/legacy/</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">å°æŠ€å·§</p>
<p>åœ¨ <code class="docutils literal notranslate"><span class="pre">testpypi</span></code> GitHub ç¯å¢ƒä¸­è¦æ±‚æ‰‹åŠ¨æ‰¹å‡†é€šå¸¸æ˜¯ä¸å¿…è¦çš„ï¼Œå› ä¸ºå®ƒæ—¨åœ¨åœ¨æ¯æ¬¡æäº¤åˆ°ä¸»åˆ†æ”¯æ—¶è¿è¡Œï¼Œé€šå¸¸ç”¨äºæŒ‡ç¤ºå¥åº·çš„å‘å¸ƒç®¡é“ã€‚</p>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>Now, repeat these steps and create another job for
publishing to the TestPyPI package index under the <code class="docutils literal notranslate"><span class="pre">jobs</span></code>
section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="nt">publish-to-testpypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to TestPyPI</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testpypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/p/&lt;package-name&gt;</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to TestPyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">repository-url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/legacy/</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">å°æŠ€å·§</p>
<p>Requiring manual approvals in the <code class="docutils literal notranslate"><span class="pre">testpypi</span></code> GitHub Environment is typically unnecessary as it's designed to run on each commit to the main branch and is often used to indicate a healthy release publishing pipeline.</p>
</div>
</div>
</div>
</section>
<section id="ci-cd">
<h2>æ•´ä¸ª CI/CD å·¥ä½œæµ<a class="headerlink" href="#ci-cd" title="Link to this heading">Â¶</a></h2>
<p><strong>The whole CI/CD workflow</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>æœ¬æ®µå±•ç¤ºäº†éµå¾ªä¸Šè¿°æŒ‡å—åçš„æ•´ä¸ªå·¥ä½œæµç¨‹ã€‚</p>
<details class="summary-click-here-to-display-the-entire-github-actions-ci-cd-workflow-definition">
<summary>Click here to display the entire GitHub Actions CI/CD workflow definition</summary><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to PyPI and TestPyPI</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">push</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build distribution ğŸ“¦</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.x&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install pypa/build</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">python3 -m</span>
<span class="w">        </span><span class="no">pip install</span>
<span class="w">        </span><span class="no">build</span>
<span class="w">        </span><span class="no">--user</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build a binary wheel and a source tarball</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3 -m build</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Store the distribution packages</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>

<span class="w">  </span><span class="nt">publish-to-pypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Publish Python ğŸ distribution ğŸ“¦ to PyPI</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">startsWith(github.ref, &#39;refs/tags/&#39;)</span><span class="w">  </span><span class="c1"># only publish to PyPI on tag pushes</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://pypi.org/p/&lt;package-name&gt;</span><span class="w">  </span><span class="c1"># Replace &lt;package-name&gt; with your PyPI project name</span>
<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to PyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>

<span class="w">  </span><span class="nt">github-release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Sign the Python ğŸ distribution ğŸ“¦ with Sigstore</span>
<span class="w">      </span><span class="no">and upload them to GitHub Release</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">publish-to-pypi</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for making GitHub Releases</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for sigstore</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Sign the dists with Sigstore</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sigstore/gh-action-sigstore-python@v3.0.0</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">          </span><span class="no">./dist/*.tar.gz</span>
<span class="w">          </span><span class="no">./dist/*.whl</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release create</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39;</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>
<span class="w">        </span><span class="no">--notes &quot;&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload artifact signatures to GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="c1"># Upload to GitHub Release using the `gh` CLI.</span>
<span class="w">      </span><span class="c1"># `dist/` contains the built packages, and the</span>
<span class="w">      </span><span class="c1"># sigstore-produced signatures and certificates.</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release upload</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39; dist/**</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>

<span class="w">  </span><span class="nt">publish-to-testpypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to TestPyPI</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testpypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/p/&lt;package-name&gt;</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to TestPyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">repository-url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/legacy/</span>
</pre></div>
</div>
</details></div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>This paragraph showcases the whole workflow after following the above guide.</p>
<details class="summary-click-here-to-display-the-entire-github-actions-ci-cd-workflow-definition">
<summary>Click here to display the entire GitHub Actions CI/CD workflow definition</summary><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to PyPI and TestPyPI</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">push</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build distribution ğŸ“¦</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v5</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.x&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install pypa/build</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">python3 -m</span>
<span class="w">        </span><span class="no">pip install</span>
<span class="w">        </span><span class="no">build</span>
<span class="w">        </span><span class="no">--user</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build a binary wheel and a source tarball</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3 -m build</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Store the distribution packages</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>

<span class="w">  </span><span class="nt">publish-to-pypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Publish Python ğŸ distribution ğŸ“¦ to PyPI</span>
<span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">startsWith(github.ref, &#39;refs/tags/&#39;)</span><span class="w">  </span><span class="c1"># only publish to PyPI on tag pushes</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://pypi.org/p/&lt;package-name&gt;</span><span class="w">  </span><span class="c1"># Replace &lt;package-name&gt; with your PyPI project name</span>
<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to PyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>

<span class="w">  </span><span class="nt">github-release</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">      </span><span class="no">Sign the Python ğŸ distribution ğŸ“¦ with Sigstore</span>
<span class="w">      </span><span class="no">and upload them to GitHub Release</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">publish-to-pypi</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">contents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for making GitHub Releases</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for sigstore</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Sign the dists with Sigstore</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sigstore/gh-action-sigstore-python@v3.0.0</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">          </span><span class="no">./dist/*.tar.gz</span>
<span class="w">          </span><span class="no">./dist/*.whl</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Create GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release create</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39;</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>
<span class="w">        </span><span class="no">--notes &quot;&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload artifact signatures to GitHub Release</span>
<span class="w">      </span><span class="nt">env</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GITHUB_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ github.token }}</span>
<span class="w">      </span><span class="c1"># Upload to GitHub Release using the `gh` CLI.</span>
<span class="w">      </span><span class="c1"># `dist/` contains the built packages, and the</span>
<span class="w">      </span><span class="c1"># sigstore-produced signatures and certificates.</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">        </span><span class="no">gh release upload</span>
<span class="w">        </span><span class="no">&#39;${{ github.ref_name }}&#39; dist/**</span>
<span class="w">        </span><span class="no">--repo &#39;${{ github.repository }}&#39;</span>

<span class="w">  </span><span class="nt">publish-to-testpypi</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish Python ğŸ distribution ğŸ“¦ to TestPyPI</span>
<span class="w">    </span><span class="nt">needs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testpypi</span>
<span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/p/&lt;package-name&gt;</span>

<span class="w">    </span><span class="nt">permissions</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write</span><span class="w">  </span><span class="c1"># IMPORTANT: mandatory for trusted publishing</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Download all the dists</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/download-artifact@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-package-distributions</span>
<span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dist/</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Publish distribution ğŸ“¦ to TestPyPI</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pypa/gh-action-pypi-publish@release/v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">repository-url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://test.pypi.org/legacy/</span>
</pre></div>
</div>
</details></div>
</div>
</section>
<section id="id8">
<h2>å°±è¿™äº›äº†ï¼Œä¼™è®¡ä»¬ï¼<a class="headerlink" href="#id8" title="Link to this heading">Â¶</a></h2>
<p><strong>That's all, folks!</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">ä¸­æ–‡</label><div class="tab-content docutils container">
<p>ç°åœ¨ï¼Œæ¯å½“ä½ å°†å¸¦æœ‰æ ‡ç­¾çš„æäº¤æ¨é€åˆ° GitHub ä¸Šçš„ Git ä»“åº“è¿œç¨‹æ—¶ï¼Œè¿™ä¸ªå·¥ä½œæµå°†ä¼šå°†å…¶å‘å¸ƒåˆ° PyPIã€‚å®ƒè¿˜ä¼šå°†ä»»ä½•æ¨é€å‘å¸ƒåˆ° TestPyPIï¼Œè¿™å¯¹æä¾›æµ‹è¯•ç‰ˆæœ¬ç»™ä½ çš„ alpha ç”¨æˆ·ä»¥åŠç¡®ä¿ä½ çš„å‘å¸ƒç®¡é“ä¿æŒå¥åº·éå¸¸æœ‰ç”¨ï¼</p>
<div class="admonition attention">
<p class="admonition-title">æ³¨æ„</p>
<p>å¦‚æœä½ çš„ä»“åº“æœ‰é¢‘ç¹çš„æäº¤æ´»åŠ¨ï¼Œå¹¶ä¸”æ¯æ¬¡æ¨é€éƒ½æŒ‰ç…§æè¿°ä¸Šä¼ åˆ° TestPyPIï¼Œé¡¹ç›®å¯èƒ½ä¼šè¶…å‡º <a class="reference external" href="https://pypi.org/help/#project-size-limit">PyPI é¡¹ç›®å¤§å°é™åˆ¶</a>ã€‚è™½ç„¶è¯¥é™åˆ¶å¯ä»¥æé«˜ï¼Œä½†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯åœ¨ CI ä¸­ä½¿ç”¨å…¼å®¹ PyPI çš„æœåŠ¡å™¨ï¼Œå¦‚ <a class="reference internal" href="../key_projects.html#pypiserver"><span class="std std-ref">pypiserver</span></a>ï¼Œç”¨äºæµ‹è¯•ç›®çš„ã€‚</p>
</div>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>æ¨èä¿æŒé›†æˆçš„ GitHub Actions åœ¨æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶å®šæœŸæ›´æ–°å®ƒä»¬ã€‚</p>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">è‹±æ–‡</label><div class="tab-content docutils container">
<p>Now, whenever you push a tagged commit to your Git repository remote
on GitHub, this workflow will publish it to PyPI.
And it'll publish any push to TestPyPI which is useful for
providing test builds to your alpha users as well as making
sure that your release pipeline remains healthy!</p>
<p>If your repository has frequent commit activity and every push is uploaded
to TestPyPI as described, the project might exceed the
<a class="reference external" href="https://pypi.org/help/#project-size-limit">PyPI project size limit</a>.
The limit could be increased, but a better solution may constitute to
use a PyPI-compatible server like <a class="reference internal" href="../key_projects.html#pypiserver"><span class="std std-ref">pypiserver</span></a> in the CI for testing purposes.</p>
<div class="admonition note">
<p class="admonition-title">å¤‡æ³¨</p>
<p>It is recommended to keep the integrated GitHub Actions at their latest
versions, updating them frequently.</p>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="modernize-setup-py-project.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">å¦‚ä½•ä½¿åŸºäº <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> çš„é¡¹ç›®ç°ä»£åŒ–ï¼Ÿ</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="making-a-pypi-friendly-readme.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">åˆ¶ä½œé€‚åˆ PyPI çš„ README</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2013â€“2020, PyPA
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2024 å¹´ 11 æœˆ 15 æ—¥</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">ä½¿ç”¨ GitHub Actions CI/CD å·¥ä½œæµå‘å¸ƒè½¯ä»¶åŒ…åˆ†å‘ç‰ˆæœ¬</a><ul>
<li><a class="reference internal" href="#id1">é…ç½®å—ä¿¡ä»»çš„å‘å¸ƒ</a></li>
<li><a class="reference internal" href="#workflow-definition">åˆ›å»ºå·¥ä½œæµå®šä¹‰</a></li>
<li><a class="reference internal" href="#id4">æ£€æŸ¥é¡¹ç›®å¹¶æ„å»ºåˆ†å‘</a></li>
<li><a class="reference internal" href="#id5">å®šä¹‰å·¥ä½œæµä½œä¸šç¯å¢ƒ</a></li>
<li><a class="reference internal" href="#pypi">å°†åˆ†å‘å‘å¸ƒåˆ° PyPI</a></li>
<li><a class="reference internal" href="#id6">ç­¾ç½²åˆ†å‘åŒ…</a></li>
<li><a class="reference internal" href="#testpypi">ç”¨äºå‘å¸ƒåˆ° TestPyPI çš„å•ç‹¬å·¥ä½œæµ</a></li>
<li><a class="reference internal" href="#ci-cd">æ•´ä¸ª CI/CD å·¥ä½œæµ</a></li>
<li><a class="reference internal" href="#id8">å°±è¿™äº›äº†ï¼Œä¼™è®¡ä»¬ï¼</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=cb5fb026"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    </body>
</html>