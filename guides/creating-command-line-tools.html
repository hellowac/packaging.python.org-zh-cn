<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="next" title="创建和发现插件" href="creating-and-discovering-plugins.html" /><link rel="prev" title="打包命名空间包" href="packaging-namespace-packages.html" />

    <link rel="shortcut icon" href="../_static/py.png"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>创建和打包命令行工具 - Python Packaging User Guide</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Python Packaging User Guide</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Python Packaging User Guide</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="../flow.html">打包流程</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">教程</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/installing-packages.html">安装软件包</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/managing-dependencies.html">管理依赖项</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/packaging-projects.html">打包Python项目</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">指南</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="section-install.html">安装</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 安装</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="installing-using-pip-and-virtual-environments.html">使用 pip 和 venv 在虚拟环境中安装软件包</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-using-virtualenv.html">使用虚拟环境安装包</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-stand-alone-command-line-tools.html">安装独立的命令行工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-using-linux-tools.html">使用 Linux 包管理器安装 pip/setuptools/wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing-scientific-packages.html">安装科学软件包</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="section-build-and-publish.html">构建和发布</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 构建和发布</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="writing-pyproject-toml.html">编写你的 <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="distributing-packages-using-setuptools.html">打包和分发项目</a></li>
<li class="toctree-l3"><a class="reference internal" href="dropping-older-python-versions.html">放弃对旧版 Python 的支持</a></li>
<li class="toctree-l3"><a class="reference internal" href="packaging-binary-extensions.html">打包二进制扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="packaging-namespace-packages.html">打包命名空间包</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">创建和打包命令行工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="creating-and-discovering-plugins.html">创建和发现插件</a></li>
<li class="toctree-l3"><a class="reference internal" href="using-testpypi.html">使用 TestPyPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="making-a-pypi-friendly-readme.html">制作适合 PyPI 的 README</a></li>
<li class="toctree-l3"><a class="reference internal" href="publishing-package-distribution-releases-using-github-actions-ci-cd-workflows.html">使用 GitHub Actions CI/CD 工作流发布软件包分发版本</a></li>
<li class="toctree-l3"><a class="reference internal" href="modernize-setup-py-project.html">如何使基于 <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> 的项目现代化？</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="section-hosting.html">托管</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of 托管</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="index-mirrors-and-caches.html">包索引镜像和缓存</a></li>
<li class="toctree-l3"><a class="reference internal" href="hosting-your-own-index.html">托管您自己的简单存储库</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tool-recommendations.html">工具推荐</a></li>
<li class="toctree-l2"><a class="reference internal" href="analyzing-pypi-package-downloads.html">分析 PyPI 软件包下载</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../discussions/index.html">讨论</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 讨论</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../discussions/versioning.html">版本控制</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/deploying-python-applications.html">部署 Python 应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/pip-vs-easy-install.html">pip vs easy_install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/install-requires-vs-requirements.html">install_requires 与需求文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/distribution-package-vs-import-package.html">分发包与导入包</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/package-formats.html">软件包格式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/src-layout-vs-flat-layout.html">src 布局与平面布局</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/setup-py-deprecated.html"><code class="docutils literal notranslate"><span class="pre">setup.py</span></code> 已被弃用吗？</a></li>
<li class="toctree-l2"><a class="reference internal" href="../discussions/single-source-version.html">单一来源项目版本</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../specifications/index.html">PyPA 规范</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of PyPA 规范</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-distribution-metadata.html">包分发元数据</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 包分发元数据</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/name-normalization.html">名称和规范化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/core-metadata.html">核心元数据规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/version-specifiers.html">版本标识符</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/dependency-specifiers.html">依赖说明符</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/pyproject-toml.html"><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> 规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/inline-script-metadata.html">内联脚本元数据</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/platform-compatibility-tags.html">平台兼容性标签</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/well-known-project-urls.html">元数据中的知名项目 URL</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-installation-metadata.html">包安装元数据</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 包安装元数据</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/recording-installed-packages.html">记录已安装的项目</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/entry-points.html">入口点规范</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/direct-url.html">记录已安装发行版的直接 URL 来源</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/direct-url-data-structure.html">直接 URL 数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/virtual-environments.html">Python 虚拟环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/externally-managed-environments.html">外部管理环境</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-distribution-formats.html">包分发文件格式</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 包分发文件格式</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/source-distribution-format.html">源分发格式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/binary-distribution-format.html">二进制分发格式</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../specifications/section-package-indices.html">包索引接口</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of 包索引接口</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../specifications/pypirc.html"><code class="file docutils literal notranslate"><span class="pre">.pypirc</span></code> 文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specifications/simple-repository-api.html">Simple 仓库 API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../key_projects.html">项目摘要</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">如何获取支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">为本指南做出贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news.html">新闻</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/guides/creating-command-line-tools.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="creating-command-line-tools">
<span id="id1"></span><h1>创建和打包命令行工具<a class="headerlink" href="#creating-command-line-tools" title="Link to this heading">¶</a></h1>
<p><strong>Creating and packaging command-line tools</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>本指南将引导你创建和打包一个独立的命令行应用程序，该应用程序可以使用 <a class="reference internal" href="../key_projects.html#pipx"><span class="std std-ref">pipx</span></a> 安装。pipx 是一个工具，用于创建和管理 <a class="reference internal" href="../glossary.html#term-Virtual-Environment"><span class="xref std std-term">Python 虚拟环境</span></a>，并暴露包的可执行脚本（以及可用的手册页）供命令行使用。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>This guide will walk you through creating and packaging a standalone command-line application
that can be installed with <a class="reference internal" href="../key_projects.html#pipx"><span class="std std-ref">pipx</span></a>, a tool creating and managing <a class="reference internal" href="../glossary.html#term-Virtual-Environment"><span class="xref std std-term">Python Virtual Environments</span></a>
and exposing the executable scripts of packages (and available manual pages) for use on the command-line.</p>
</div>
</div>
<section id="id2">
<h2>创建包<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p><strong>Creating the package</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>首先，为 <a class="reference internal" href="../glossary.html#term-Project"><span class="xref std std-term">项目</span></a> 创建一个源代码目录结构。为了举例说明，我们将构建一个简单的工具，该工具根据命令行中给出的参数输出一个问候语（一个字符串）。</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">待处理</p>
<p>在另一个指南或讨论中建议 Python 包的最佳结构，并在此处提供链接。</p>
</div>
<p>该项目将遵循 <a class="reference internal" href="../discussions/src-layout-vs-flat-layout.html#src-layout-vs-flat-layout"><span class="std std-ref">src-layout</span></a> 结构，最终将呈现以下文件树，顶级文件夹和包名为 <code class="docutils literal notranslate"><span class="pre">greetings</span></code>：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── pyproject.toml
└── src
    └── greetings
        ├── cli.py
        ├── greet.py
        ├── __init__.py
        └── __main__.py
</pre></div>
</div>
<p>负责工具功能的实际代码将存储在 <code class="file docutils literal notranslate"><span class="pre">greet.py</span></code> 文件中，文件名与主模块相同：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">typer</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>


<span class="k">def</span> <span class="nf">greet</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Argument</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The (last, if --gender is given) name of the person to greet&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">gender</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The gender of the person to greet&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">knight</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Whether the person is a knight&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">count</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of times to greet the person&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">):</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="s2">&quot;Greetings, dear &quot;</span>
    <span class="n">masculine</span> <span class="o">=</span> <span class="n">gender</span> <span class="o">==</span> <span class="s2">&quot;masculine&quot;</span>
    <span class="n">feminine</span> <span class="o">=</span> <span class="n">gender</span> <span class="o">==</span> <span class="s2">&quot;feminine&quot;</span>
    <span class="k">if</span> <span class="n">gender</span> <span class="ow">or</span> <span class="n">knight</span><span class="p">:</span>
        <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">knight</span><span class="p">:</span>
            <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;Sir &quot;</span>
        <span class="k">elif</span> <span class="n">masculine</span><span class="p">:</span>
            <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;Mr. &quot;</span>
        <span class="k">elif</span> <span class="n">feminine</span><span class="p">:</span>
            <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;Ms. &quot;</span>
        <span class="n">greeting</span> <span class="o">+=</span> <span class="n">salutation</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pronoun</span> <span class="o">=</span> <span class="s2">&quot;her&quot;</span> <span class="k">if</span> <span class="n">feminine</span> <span class="k">else</span> <span class="s2">&quot;his&quot;</span> <span class="k">if</span> <span class="n">masculine</span> <span class="ow">or</span> <span class="n">knight</span> <span class="k">else</span> <span class="s2">&quot;its&quot;</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;what&#39;s-</span><span class="si">{</span><span class="n">pronoun</span><span class="si">}</span><span class="s2">-name&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">gender</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="s2">&quot;friend!&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">greeting</span><span class="p">)</span>
</pre></div>
</div>
<p>上述函数接受多个关键字参数，用于确定如何构建输出的问候语。接下来，构建命令行接口以提供这些功能，这将在 <code class="file docutils literal notranslate"><span class="pre">cli.py</span></code> 中完成：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">typer</span>

<span class="kn">from</span> <span class="nn">.greet</span> <span class="kn">import</span> <span class="n">greet</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Typer</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">command</span><span class="p">()(</span><span class="n">greet</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="p">()</span>
</pre></div>
</div>
<p>命令行接口是使用 <a class="reference external" href="https://typer.tiangolo.com/">typer</a> 构建的，它是一个基于 Python 类型提示的易用 CLI 解析器。它提供了自动补全和漂亮的命令行帮助。另一种选择是 <a class="reference external" href="https://docs.python.org/zh-cn/3/library/argparse.html#module-argparse" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>，这是 Python 标准库中包含的命令行解析器，适用于大多数需求，但通常需要在 <code class="docutils literal notranslate"><span class="pre">cli.py</span></code> 中编写大量代码以确保正常工作。另一个选择是 <a class="reference external" href="https://docopt.readthedocs.io/en/latest/">docopt</a>，它使得仅基于文档字符串创建 CLI 接口成为可能；高级用户可以使用 <a class="reference external" href="https://click.palletsprojects.com/">click</a> （<code class="docutils literal notranslate"><span class="pre">typer</span></code> 就是基于 click 构建的）。</p>
<p>现在，添加一个空的 <code class="file docutils literal notranslate"><span class="pre">__init__.py</span></code> 文件，以将项目定义为常规的 <a class="reference internal" href="../glossary.html#term-Import-Package"><span class="xref std std-term">导入包</span></a>。</p>
<p>文件 <code class="file docutils literal notranslate"><span class="pre">__main__.py</span></code> 标志着通过 <a class="reference external" href="https://docs.python.org/zh-cn/3/library/runpy.html#module-runpy" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">runpy</span></code></a> 运行应用程序时的主要入口点（即 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">greetings</span></code>，在平面布局中可以立即使用，但需要安装具有 src 布局的包），因此在这里初始化命令行接口：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">greetings.cli</span> <span class="kn">import</span> <span class="n">app</span>
    <span class="n">app</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>为了支持直接从 <a class="reference internal" href="../glossary.html#term-Project-Source-Tree"><span class="xref std std-term">源代码目录</span></a> 调用命令行接口，
即作为 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">src/greetings</span></code>，可以在此文件中加入某些 hack；更多信息请阅读
<a class="reference internal" href="../discussions/src-layout-vs-flat-layout.html#running-cli-from-source-src-layout"><span class="std std-ref">使用 src-layout 从源代码运行命令行界面</span></a> 。</p>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>First of all, create a source tree for the <a class="reference internal" href="../glossary.html#term-Project"><span class="xref std std-term">project</span></a>. For the sake of an example, we'll
build a simple tool outputting a greeting (a string) for a person based on arguments given on the command-line.</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">待处理</p>
<p>Advise on the optimal structure of a Python package in another guide or discussion and link to it here.</p>
</div>
<p>This project will adhere to <a class="reference internal" href="../discussions/src-layout-vs-flat-layout.html#src-layout-vs-flat-layout"><span class="std std-ref">src-layout</span></a> and in the end be alike this file tree,
with the top-level folder and package name <code class="docutils literal notranslate"><span class="pre">greetings</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── pyproject.toml
└── src
    └── greetings
        ├── cli.py
        ├── greet.py
        ├── __init__.py
        └── __main__.py
</pre></div>
</div>
<p>The actual code responsible for the tool's functionality will be stored in the file <code class="file docutils literal notranslate"><span class="pre">greet.py</span></code>,
named after the main module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">typer</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>


<span class="k">def</span> <span class="nf">greet</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Argument</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The (last, if --gender is given) name of the person to greet&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">gender</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;The gender of the person to greet&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">knight</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Whether the person is a knight&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">count</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of times to greet the person&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">):</span>
    <span class="n">greeting</span> <span class="o">=</span> <span class="s2">&quot;Greetings, dear &quot;</span>
    <span class="n">masculine</span> <span class="o">=</span> <span class="n">gender</span> <span class="o">==</span> <span class="s2">&quot;masculine&quot;</span>
    <span class="n">feminine</span> <span class="o">=</span> <span class="n">gender</span> <span class="o">==</span> <span class="s2">&quot;feminine&quot;</span>
    <span class="k">if</span> <span class="n">gender</span> <span class="ow">or</span> <span class="n">knight</span><span class="p">:</span>
        <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">knight</span><span class="p">:</span>
            <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;Sir &quot;</span>
        <span class="k">elif</span> <span class="n">masculine</span><span class="p">:</span>
            <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;Mr. &quot;</span>
        <span class="k">elif</span> <span class="n">feminine</span><span class="p">:</span>
            <span class="n">salutation</span> <span class="o">=</span> <span class="s2">&quot;Ms. &quot;</span>
        <span class="n">greeting</span> <span class="o">+=</span> <span class="n">salutation</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pronoun</span> <span class="o">=</span> <span class="s2">&quot;her&quot;</span> <span class="k">if</span> <span class="n">feminine</span> <span class="k">else</span> <span class="s2">&quot;his&quot;</span> <span class="k">if</span> <span class="n">masculine</span> <span class="ow">or</span> <span class="n">knight</span> <span class="k">else</span> <span class="s2">&quot;its&quot;</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;what&#39;s-</span><span class="si">{</span><span class="n">pronoun</span><span class="si">}</span><span class="s2">-name&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">gender</span><span class="p">:</span>
            <span class="n">greeting</span> <span class="o">+=</span> <span class="s2">&quot;friend!&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">greeting</span><span class="p">)</span>
</pre></div>
</div>
<p>The above function receives several keyword arguments that determine how the greeting to output is constructed.
Now, construct the command-line interface to provision it with the same, which is done
in <code class="file docutils literal notranslate"><span class="pre">cli.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">typer</span>

<span class="kn">from</span> <span class="nn">.greet</span> <span class="kn">import</span> <span class="n">greet</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Typer</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">command</span><span class="p">()(</span><span class="n">greet</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="p">()</span>
</pre></div>
</div>
<p>The command-line interface is built with <a class="reference external" href="https://typer.tiangolo.com/">typer</a>, an easy-to-use CLI parser based on Python type hints. It provides
auto-completion and nicely styled command-line help out of the box. Another option would be <a class="reference external" href="https://docs.python.org/zh-cn/3/library/argparse.html#module-argparse" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>,
a command-line parser which is included in Python's standard library. It is sufficient for most needs, but requires
a lot of code, usually in <code class="docutils literal notranslate"><span class="pre">cli.py</span></code>, to function properly. Alternatively, <a class="reference external" href="https://docopt.readthedocs.io/en/latest/">docopt</a> makes it possible to create CLI
interfaces based solely on docstrings; advanced users are encouraged to make use of <a class="reference external" href="https://click.palletsprojects.com/">click</a> (on which <code class="docutils literal notranslate"><span class="pre">typer</span></code> is based).</p>
<p>Now, add an empty <code class="file docutils literal notranslate"><span class="pre">__init__.py</span></code> file, to define the project as a regular <a class="reference internal" href="../glossary.html#term-Import-Package"><span class="xref std std-term">import package</span></a>.</p>
<p>The file <code class="file docutils literal notranslate"><span class="pre">__main__.py</span></code> marks the main entry point for the application when running it via <a class="reference external" href="https://docs.python.org/zh-cn/3/library/runpy.html#module-runpy" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">runpy</span></code></a>
(i.e. <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">greetings</span></code>, which works immediately with flat layout, but requires installation of the package with src layout),
so initizalize the command-line interface here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">greetings.cli</span> <span class="kn">import</span> <span class="n">app</span>
    <span class="n">app</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>In order to enable calling the command-line interface directly from the <a class="reference internal" href="../glossary.html#term-Project-Source-Tree"><span class="xref std std-term">source tree</span></a>,
i.e. as <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">src/greetings</span></code>, a certain hack could be placed in this file; read more at
<a class="reference internal" href="../discussions/src-layout-vs-flat-layout.html#running-cli-from-source-src-layout"><span class="std std-ref">使用 src-layout 从源代码运行命令行界面</span></a>.</p>
</div>
</div>
</div>
<section id="pyproject-toml">
<h3><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code><a class="headerlink" href="#pyproject-toml" title="Link to this heading">¶</a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>项目的 <a class="reference internal" href="../glossary.html#term-Pyproject-Metadata"><span class="xref std std-term">元数据</span></a> 放在 <a class="reference internal" href="../glossary.html#term-pyproject.toml"><span class="xref std std-term">pyproject.toml</span></a> 文件中。可以按照 <a class="reference internal" href="writing-pyproject-toml.html#writing-pyproject-toml"><span class="std std-ref">编写你的 pyproject.toml</span></a> 中的说明填写 <a class="reference internal" href="../glossary.html#term-Pyproject-Metadata-Key"><span class="xref std std-term">pyproject 元数据键</span></a> 和 <code class="docutils literal notranslate"><span class="pre">[build-system]</span></code> 表格，并添加对 <code class="docutils literal notranslate"><span class="pre">typer</span></code> 的依赖（本教程使用版本 <em>0.12.3</em>）。</p>
<p>为了使该项目被识别为一个命令行工具，还需要添加一个 <code class="docutils literal notranslate"><span class="pre">console_scripts</span></code> <a class="reference internal" href="../specifications/entry-points.html#entry-points"><span class="std std-ref">入口点</span></a> （参见 <a class="reference internal" href="writing-pyproject-toml.html#console-scripts"><span class="std std-ref">创建可执行脚本</span></a>），作为一个 <a class="reference internal" href="../glossary.html#term-Pyproject-Metadata-Subkey"><span class="xref std std-term">子键</span></a> :</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.scripts]</span>
<span class="n">greet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;greetings.cli:app&quot;</span>
</pre></div>
</div>
<p>现在，项目的源代码目录已准备好转化为一个 <a class="reference internal" href="../glossary.html#term-Distribution-Package"><span class="xref std std-term">分发包</span></a>，
使其能够被安装。</p>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>The project's <a class="reference internal" href="../glossary.html#term-Pyproject-Metadata"><span class="xref std std-term">metadata</span></a> is placed in <a class="reference internal" href="../glossary.html#term-pyproject.toml"><span class="xref std std-term">pyproject.toml</span></a>. The <a class="reference internal" href="../glossary.html#term-Pyproject-Metadata-Key"><span class="xref std std-term">pyproject metadata keys</span></a> and the <code class="docutils literal notranslate"><span class="pre">[build-system]</span></code> table may be filled in as described in <a class="reference internal" href="writing-pyproject-toml.html#writing-pyproject-toml"><span class="std std-ref">编写你的 pyproject.toml</span></a>, adding a dependency
on <code class="docutils literal notranslate"><span class="pre">typer</span></code> (this tutorial uses version <em>0.12.3</em>).</p>
<p>For the project to be recognised as a command-line tool, additionally a <code class="docutils literal notranslate"><span class="pre">console_scripts</span></code> <a class="reference internal" href="../specifications/entry-points.html#entry-points"><span class="std std-ref">entry point</span></a> (see <a class="reference internal" href="writing-pyproject-toml.html#console-scripts"><span class="std std-ref">创建可执行脚本</span></a>) needs to be added as a <a class="reference internal" href="../glossary.html#term-Pyproject-Metadata-Subkey"><span class="xref std std-term">subkey</span></a>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.scripts]</span>
<span class="n">greet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;greetings.cli:app&quot;</span>
</pre></div>
</div>
<p>Now, the project's source tree is ready to be transformed into a <a class="reference internal" href="../glossary.html#term-Distribution-Package"><span class="xref std std-term">distribution package</span></a>,
which makes it installable.</p>
</div>
</div>
</section>
</section>
<section id="pipx">
<h2>使用 <code class="docutils literal notranslate"><span class="pre">pipx</span></code> 安装包<a class="headerlink" href="#pipx" title="Link to this heading">¶</a></h2>
<p><strong>Installing the package with</strong> <code class="docutils literal notranslate"><span class="pre">pipx</span></code></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p>按照 <a class="reference internal" href="installing-stand-alone-command-line-tools.html#installing-stand-alone-command-line-tools"><span class="std std-ref">安装独立的命令行工具</span></a> 中的说明安装 <code class="docutils literal notranslate"><span class="pre">pipx</span></code> 后，安装你的项目：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>path/to/greetings/
<span class="gp">$ </span>pipx<span class="w"> </span>install<span class="w"> </span>.
</pre></div>
</div>
<p>这将暴露我们定义的作为入口点的可执行脚本，并使得 <code class="docutils literal notranslate"><span class="pre">greet</span></code> 命令可用。我们来测试一下：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>greet<span class="w"> </span>--knight<span class="w"> </span>Lancelot
<span class="go">Greetings, dear Sir Lancelot!</span>
<span class="gp">$ </span>greet<span class="w"> </span>--gender<span class="w"> </span>feminine<span class="w"> </span>Parks
<span class="go">Greetings, dear Ms. Parks!</span>
<span class="gp">$ </span>greet<span class="w"> </span>--gender<span class="w"> </span>masculine
<span class="go">Greetings, dear Mr. what&#39;s-his-name!</span>
</pre></div>
</div>
<p>由于这个示例使用了 <code class="docutils literal notranslate"><span class="pre">typer</span></code>，你现在也可以通过添加 <code class="docutils literal notranslate"><span class="pre">--help</span></code> 选项来查看程序的使用概览，或者通过 <code class="docutils literal notranslate"><span class="pre">--install-completion</span></code> 选项配置自动补全。</p>
<p>如果你只想运行程序而不永久安装，可以使用 <code class="docutils literal notranslate"><span class="pre">pipx</span> <span class="pre">run</span></code>，它将为该程序创建一个临时（但会缓存的）虚拟环境：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pipx<span class="w"> </span>run<span class="w"> </span>--spec<span class="w"> </span>.<span class="w"> </span>greet<span class="w"> </span>--knight
</pre></div>
</div>
<p>然而，这种语法有点不方便；由于我们上面定义的入口点名称与包名不匹配，因此我们需要明确指定要运行的可执行脚本（即使目前只有一个脚本）。</p>
<p>不过，解决这个问题有一个更实用的办法，通过为 <code class="docutils literal notranslate"><span class="pre">pipx</span> <span class="pre">run</span></code> 定义特定的入口点。可以在 <code class="file docutils literal notranslate"><span class="pre">pyproject.toml</span></code> 中如下定义：</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.entry-points.</span><span class="s2">&quot;pipx.run&quot;</span><span class="k">]</span>
<span class="n">greetings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;greetings.cli:app&quot;</span>
</pre></div>
</div>
<p>由于这个入口点（<em>必须</em> 与包名匹配），<code class="docutils literal notranslate"><span class="pre">pipx</span></code> 将把可执行脚本作为默认脚本来运行，这样就可以执行以下命令：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pipx<span class="w"> </span>run<span class="w"> </span>.<span class="w"> </span>--knight
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>After installing <code class="docutils literal notranslate"><span class="pre">pipx</span></code> as described in <a class="reference internal" href="installing-stand-alone-command-line-tools.html#installing-stand-alone-command-line-tools"><span class="std std-ref">安装独立的命令行工具</span></a>, install your project:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>path/to/greetings/
<span class="gp">$ </span>pipx<span class="w"> </span>install<span class="w"> </span>.
</pre></div>
</div>
<p>This will expose the executable script we defined as an entry point and make the command <code class="docutils literal notranslate"><span class="pre">greet</span></code> available.
Let's test it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>greet<span class="w"> </span>--knight<span class="w"> </span>Lancelot
<span class="go">Greetings, dear Sir Lancelot!</span>
<span class="gp">$ </span>greet<span class="w"> </span>--gender<span class="w"> </span>feminine<span class="w"> </span>Parks
<span class="go">Greetings, dear Ms. Parks!</span>
<span class="gp">$ </span>greet<span class="w"> </span>--gender<span class="w"> </span>masculine
<span class="go">Greetings, dear Mr. what&#39;s-his-name!</span>
</pre></div>
</div>
<p>Since this example uses <code class="docutils literal notranslate"><span class="pre">typer</span></code>, you could now also get an overview of the program's usage by calling it with
the <code class="docutils literal notranslate"><span class="pre">--help</span></code> option, or configure completions via the <code class="docutils literal notranslate"><span class="pre">--install-completion</span></code> option.</p>
<p>To just run the program without installing it permanently, use <code class="docutils literal notranslate"><span class="pre">pipx</span> <span class="pre">run</span></code>, which will create a temporary
(but cached) virtual environment for it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pipx<span class="w"> </span>run<span class="w"> </span>--spec<span class="w"> </span>.<span class="w"> </span>greet<span class="w"> </span>--knight
</pre></div>
</div>
<p>This syntax is a bit unpractical, however; as the name of the entry point we defined above does not match the package name,
we need to state explicitly which executable script to run (even though there is only on in existence).</p>
<p>There is, however, a more practical solution to this problem, in the form of an entry point specific to <code class="docutils literal notranslate"><span class="pre">pipx</span> <span class="pre">run</span></code>.
The same can be defined as follows in <code class="file docutils literal notranslate"><span class="pre">pyproject.toml</span></code>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.entry-points.</span><span class="s2">&quot;pipx.run&quot;</span><span class="k">]</span>
<span class="n">greetings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;greetings.cli:app&quot;</span>
</pre></div>
</div>
<p>Thanks to this entry point (which <em>must</em> match the package name), <code class="docutils literal notranslate"><span class="pre">pipx</span></code> will pick up the executable script as the
default one and run it, which makes this command possible:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pipx<span class="w"> </span>run<span class="w"> </span>.<span class="w"> </span>--knight
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2>结论<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<p><strong>Conclusion</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p>到现在为止，你已经知道如何打包一个用 Python 编写的命令行应用程序。下一步可以是将你的包发布出去，即将其上传到 <a class="reference internal" href="../glossary.html#term-Package-Index"><span class="xref std std-term">包索引</span></a>，最常见的是 <a class="reference internal" href="../glossary.html#term-Python-Package-Index-PyPI"><span class="xref std std-term">PyPI</span></a>。为此，按照 <a class="reference internal" href="distributing-packages-using-setuptools.html#packaging-your-project"><span class="std std-ref">打包您的项目</span></a> 中的说明进行操作。完成后，别忘了 <a class="reference internal" href="analyzing-pypi-package-downloads.html#analyzing-pypi-package-downloads"><span class="std std-ref">做一些研究</span></a>，了解你的包是如何被接受的！</p>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p>You know by now how to package a command-line application written in Python. A further step could be to distribute you package,
meaning uploading it to a <a class="reference internal" href="../glossary.html#term-Package-Index"><span class="xref std std-term">package index</span></a>, most commonly <a class="reference internal" href="../glossary.html#term-Python-Package-Index-PyPI"><span class="xref std std-term">PyPI</span></a>. To do that, follow the instructions at <a class="reference internal" href="distributing-packages-using-setuptools.html#packaging-your-project"><span class="std std-ref">打包您的项目</span></a>. And once you're done, don't forget to <a class="reference internal" href="analyzing-pypi-package-downloads.html#analyzing-pypi-package-downloads"><span class="std std-ref">do some research</span></a> on how your package is received!</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="creating-and-discovering-plugins.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">创建和发现插件</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="packaging-namespace-packages.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">打包命名空间包</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2013–2020, PyPA
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2024 年 11 月 15 日</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">创建和打包命令行工具</a><ul>
<li><a class="reference internal" href="#id2">创建包</a><ul>
<li><a class="reference internal" href="#pyproject-toml"><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pipx">使用 <code class="docutils literal notranslate"><span class="pre">pipx</span></code> 安装包</a></li>
<li><a class="reference internal" href="#id5">结论</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=cb5fb026"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    </body>
</html>